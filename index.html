<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeHer - Women Safety App üíó</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #fce7f3;
            font-family: 'Segoe UI', 'Trebuchet MS', sans-serif;
            color: #333;
            min-height: 100vh;
        }

        header {
            background-color: #fbcfe8;
            border-bottom: 4px solid #ec4899;
            position: sticky;
            top: 0;
            z-index: 40;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content h1 {
            color: #be185d;
            font-size: 2rem;
            font-weight: bold;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        select, button {
            font-family: inherit;
            font-weight: 600;
            border: none;
            cursor: pointer;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
        }

        .language-select {
            color: #be185d;
            background-color: #fff;
            border: 2px solid #ec4899;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
        }

        .flashlight-btn {
            padding: 0.75rem;
            border-radius: 50%;
            font-size: 1.25rem;
            background-color: #fcd34d;
            color: #78350f;
        }

        .flashlight-btn.active {
            background-color: #fbbf24;
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
            padding-bottom: 8rem;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Emergency Button Styles */
        @keyframes emergencyPulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7),
                            0 0 0 0 rgba(220, 38, 38, 0.5),
                            0 0 0 0 rgba(220, 38, 38, 0.3);
            }
            50% {
                box-shadow: 0 0 0 15px rgba(220, 38, 38, 0),
                            0 0 0 35px rgba(220, 38, 38, 0),
                            0 0 0 55px rgba(220, 38, 38, 0);
            }
        }

        @keyframes emergencyShake {
            0%, 100% { transform: translateX(0) scale(1); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px) scale(1.02); }
            20%, 40%, 60%, 80% { transform: translateX(3px) scale(1.02); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .emergency-btn {
            width: 100%;
            max-width: 600px;
            padding: 4rem 2rem;
            margin: 0 auto 2rem;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 1.875rem;
            border: 4px solid #7f1d1d;
            background-color: #ef4444;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            position: relative;
        }

        .emergency-btn:hover:not(.active) {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .emergency-btn:active:not(.active) {
            transform: scale(0.95);
        }

        .emergency-btn.active {
            background-color: #dc2626;
            animation: emergencyPulse 1.5s infinite, emergencyShake 0.3s infinite;
            box-shadow: 0 0 40px rgba(220, 38, 38, 0.8), 0 0 80px rgba(220, 38, 38, 0.4);
        }

        .emergency-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            text-align: center;
        }

        .emergency-icon {
            font-size: 3.75rem;
        }

        .emergency-icon.bounce {
            animation: bounce 0.6s infinite;
        }

        .emergency-title {
            font-weight: 900;
            font-size: 1.875rem;
            line-height: 1.25;
        }

        .emergency-subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Quick Actions Grid */
        .grid {
            display: grid;
            gap: 1.5rem;
            margin: 2rem 0;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .action-btn {
            padding: 2rem;
            border-radius: 1rem;
            font-weight: bold;
            font-size: 1.25rem;
            border: 3px solid;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
            text-align: center;
        }

        .action-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .action-btn.routes {
            background-color: #f97316;
            border-color: #7c2d12;
        }

        .action-btn.contacts {
            background-color: #8b5cf6;
            border-color: #3730a3;
        }

        .action-btn.location {
            background-color: #06b6d4;
            border-color: #164e63;
        }

        .action-btn.chat {
            background-color: #10b981;
            border-color: #064e3b;
        }

        .action-icon {
            font-size: 2.25rem;
        }

        /* Safety Tips */
        .safety-tips {
            background-color: #fda4af;
            border: 4px solid #be185d;
            border-radius: 1.5rem;
            padding: 2rem;
            margin: 2rem 0;
        }

        .safety-tips h2 {
            color: #be185d;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .safety-tips p {
            color: #831843;
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        /* Contact Cards */
        .contact-card {
            background-color: #fee2e2;
            border: 4px solid #dc2626;
            border-radius: 1rem;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
            color: inherit;
        }

        .contact-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .contact-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .contact-name {
            color: #991b1b;
            font-weight: bold;
            font-size: 1.125rem;
        }

        .contact-number {
            color: #dc2626;
            font-weight: bold;
            font-size: 1.5rem;
            margin-top: 0.5rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 50;
            flex-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        @media (min-width: 640px) {
            .modal.active {
                align-items: center;
            }
        }

        .modal-content {
            width: 100%;
            max-width: 384px;
            background-color: #fbcfe8;
            border-top: 4px solid #ec4899;
            border-radius: 1.5rem 1.5rem 0 0;
            display: flex;
            flex-direction: column;
            height: 384px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        @media (min-width: 640px) {
            .modal-content {
                border-radius: 1.5rem;
                border-top: 4px solid #ec4899;
                max-height: 384px;
            }
        }

        .modal-header {
            padding: 1rem;
            border-bottom: 2px solid #ec4899;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: #be185d;
            font-size: 1.25rem;
            font-weight: bold;
        }

        .close-btn {
            background-color: transparent;
            border: none;
            color: #be185d;
            cursor: pointer;
            font-size: 1.5rem;
            padding: 0.5rem;
        }

        .close-btn:hover {
            background-color: #fda4af;
        }

        .modal-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background-color: #fff;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .modal-messages.empty {
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .chat-message {
            display: flex;
            padding: 0.75rem;
            border-radius: 0.5rem;
        }

        .chat-message.user {
            justify-content: flex-end;
        }

        .chat-bubble {
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            max-width: 280px;
        }

        .chat-message.user .chat-bubble {
            background-color: #ec4899;
            color: white;
        }

        .chat-message.assistant .chat-bubble {
            background-color: #fce7f3;
            color: #831843;
        }

        .modal-input {
            padding: 1rem;
            border-top: 2px solid #ec4899;
            display: flex;
            gap: 0.5rem;
        }

        .modal-input input {
            flex: 1;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 2px solid #ec4899;
            font-family: inherit;
            font-weight: 600;
        }

        .modal-input button {
            padding: 0.5rem 1rem;
            background-color: #ec4899;
            color: white;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        .modal-input button:hover {
            opacity: 0.9;
        }

        /* Bottom Navigation */
        nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            border-top: 4px solid #ec4899;
            background-color: #fbcfe8;
            display: flex;
            justify-content: space-around;
            padding: 1rem 1.5rem;
            z-index: 30;
        }

        nav button {
            padding: 0.75rem;
            border-radius: 50%;
            font-size: 1.5rem;
            background-color: #fcd34d;
            color: #78350f;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        nav button.active {
            background-color: #ec4899;
            color: #fff;
            transform: scale(1.1);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* Utility Classes */
        .back-btn {
            padding: 0.75rem 1.5rem;
            background-color: #6b7280;
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            cursor: pointer;
        }

        .back-btn:hover {
            background-color: #4b5563;
        }

        h2 {
            color: #be185d;
            font-size: 1.875rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
        }

        h3 {
            color: #be185d;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .location-shared-badge {
            color: #10b981;
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }

        @media (max-width: 768px) {
            .header-content h1 {
                font-size: 1.5rem;
            }

            main {
                padding: 1rem;
            }

            .emergency-btn {
                padding: 2rem 1rem;
                font-size: 1.5rem;
            }

            .grid {
                grid-template-columns: 1fr;
            }
        }

        /* ‚îÄ‚îÄ Dark Mode Toggle Button ‚îÄ‚îÄ */
        .dark-mode-btn {
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            background-color: #fff;
            color: #be185d;
            border: 2px solid #ec4899;
            font-size: 0.875rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.4rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .dark-mode-btn:hover {
            background-color: #fce7f3;
        }

        /* ‚îÄ‚îÄ Global Transition for theme switch ‚îÄ‚îÄ */
        body, header, main, nav,
        .modal, .modal-content, .modal-messages,
        .safety-tips, .contact-card,
        .modal-input, .modal-header,
        .header-content, h2, h3,
        .safety-tips h2, .safety-tips p,
        .contact-name, .contact-number,
        select, button, input {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           DARK MODE OVERRIDES
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

        /* Base */
        body.dark-mode {
            background-color: #000000 !important;
            color: #ffffff !important;
        }

        /* Header */
        body.dark-mode header {
            background-color: #000000 !important;
            border-bottom-color: #ec4899;
        }
        body.dark-mode .header-content h1 {
            color: #ffffff !important;
        }

        /* Main area */
        body.dark-mode main {
            background-color: #000000 !important;
        }

        /* Bottom Nav */
        body.dark-mode nav {
            background-color: #000000 !important;
            border-top-color: #ec4899;
        }
        body.dark-mode nav button {
            background-color: #ec4899 !important;
            color: #ffffff !important;
        }
        body.dark-mode nav button.active {
            background-color: #ec4899 !important;
            color: #ffffff !important;
        }

        /* All generic buttons ‚Üí pink */
        body.dark-mode button {
            background-color: #ec4899 !important;
            color: #ffffff !important;
        }

        /* Flashlight button keeps its identity in dark mode but turns pink */
        body.dark-mode .flashlight-btn {
            background-color: #ec4899 !important;
            color: #ffffff !important;
        }
        body.dark-mode .flashlight-btn.active {
            background-color: #db2777 !important;
        }

        /* Dark mode toggle button itself */
        body.dark-mode .dark-mode-btn {
            background-color: #ec4899 !important;
            color: #ffffff !important;
            border-color: #ffffff !important;
        }

        /* Language select */
        body.dark-mode .language-select {
            background-color: #111111 !important;
            color: #ffffff !important;
            border-color: #ec4899 !important;
        }
        body.dark-mode .language-select option {
            background-color: #111111 !important;
            color: #ffffff !important;
        }

        /* Action buttons (routes, contacts, location, chat) keep their colours ‚Äî readable on black */
        body.dark-mode .action-btn.routes {
            background-color: #ea580c !important;
            color: #ffffff !important;
        }
        body.dark-mode .action-btn.contacts {
            background-color: #7c3aed !important;
            color: #ffffff !important;
        }
        body.dark-mode .action-btn.location {
            background-color: #0891b2 !important;
            color: #ffffff !important;
        }
        body.dark-mode .action-btn.chat {
            background-color: #059669 !important;
            color: #ffffff !important;
        }

        /* Back button */
        body.dark-mode .back-btn {
            background-color: #ec4899 !important;
            color: #ffffff !important;
        }

        /* Safety Tips section */
        body.dark-mode .safety-tips {
            background-color: #000000 !important;
            border-color: #ec4899 !important;
        }
        body.dark-mode .safety-tips h2 {
            color: #ec4899 !important;
        }
        body.dark-mode .safety-tips p {
            color: #ffffff !important;
        }

        /* Contact Cards (emergency) */
        body.dark-mode .contact-card {
            background-color: #000000 !important;
            border-color: #ec4899 !important;
        }
        body.dark-mode .contact-name {
            color: #ec4899 !important;
        }
        body.dark-mode .contact-number {
            color: #ffffff !important;
        }

        /* h2, h3 headings */
        body.dark-mode h2,
        body.dark-mode h3 {
            color: #ec4899 !important;
        }

        /* Trusted Contacts ‚Äî override inline styles via attribute selector */
        body.dark-mode #trustedContactsList a {
            background-color: #000000 !important;
            border-color: #ec4899 !important;
            color: #ffffff !important;
        }
        body.dark-mode #trustedContactsList a div {
            color: #ec4899 !important;
        }

        /* Routes page inline-styled elements */
        body.dark-mode .action-btn[style] {
            background-color: #ec4899 !important;
            color: #ffffff !important;
            border-color: #ec4899 !important;
        }
        body.dark-mode div[style*="background-color: #fef3c7"] {
            background-color: #000000 !important;
            border-color: #ec4899 !important;
        }
        body.dark-mode p[style*="color: #92400e"] {
            color: #ffffff !important;
        }
        body.dark-mode button[style*="background-color: #d97706"] {
            background-color: #ec4899 !important;
            color: #ffffff !important;
        }

        /* Modal overlay */
        body.dark-mode .modal {
            background-color: rgba(0, 0, 0, 0.85) !important;
        }

        /* Modal content box */
        body.dark-mode .modal-content {
            background-color: #000000 !important;
            border-top-color: #ec4899 !important;
        }
        body.dark-mode .modal-header {
            border-bottom-color: #ec4899 !important;
        }
        body.dark-mode .modal-header h3 {
            color: #ec4899 !important;
        }

        /* Chat messages area */
        body.dark-mode .modal-messages {
            background-color: #111111 !important;
        }
        body.dark-mode .chat-message.assistant .chat-bubble {
            background-color: #1a1a1a !important;
            color: #ffffff !important;
        }

        /* Close button */
        body.dark-mode .close-btn {
            background-color: transparent !important;
            color: #ec4899 !important;
        }
        body.dark-mode .close-btn:hover {
            background-color: #1a1a1a !important;
        }

        /* Modal input bar */
        body.dark-mode .modal-input {
            border-top-color: #ec4899 !important;
            background-color: #000000 !important;
        }
        body.dark-mode .modal-input input {
            background-color: #111111 !important;
            color: #ffffff !important;
            border-color: #ec4899 !important;
        }
        body.dark-mode .modal-input input::placeholder {
            color: #888888 !important;
        }
        body.dark-mode .modal-input button {
            background-color: #ec4899 !important;
            color: #ffffff !important;
        }

        /* Chat ask-help text */
        body.dark-mode #askHelpText {
            color: #ec4899 !important;
        }

        /* Page background (the .page divs) */
        body.dark-mode .page {
            background-color: #000000 !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <h1>üíó <span id="appName">SafeHer</span></h1>
            <div class="header-controls">
                <select class="language-select" id="languageSelect" onchange="changeLanguage()">
                    <option value="en">English</option>
                    <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
                </select>
                <button class="dark-mode-btn" id="darkModeBtn" onclick="toggleDarkMode()">üåô Dark</button>
                <button class="flashlight-btn" id="flashlightBtn" onclick="toggleFlashlight()">üî¶</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Home Page -->
        <div id="homePage" class="page active">
            <!-- Emergency Button -->
            <div class="emergency-btn" id="emergencyBtn" onclick="toggleEmergency()">
                <div class="emergency-content">
                    <div class="emergency-icon" id="emergencyIcon">‚ö†Ô∏è</div>
                    <div class="emergency-title" id="emergencyTitle">Tap to Activate Emergency</div>
                    <div class="emergency-subtitle" id="emergencySubtitle">Tap & Hold for 3 Seconds</div>
                </div>
            </div>

            <!-- Quick Actions Grid -->
            <div class="grid">
                <button class="action-btn routes" onclick="navigateTo('routesPage')">
                    <span class="action-icon">üó∫Ô∏è</span>
                    <span id="saferRouteText">Safer Routes</span>
                </button>
                <button class="action-btn contacts" onclick="navigateTo('contactsPage')">
                    <span class="action-icon">üìû</span>
                    <span id="contactsText">Emergency Contacts</span>
                </button>
                <button class="action-btn location" onclick="toggleLocationSharing()">
                    <span class="action-icon">üìç</span>
                    <span id="locationText">Share Location</span>
                    <span id="locationStatus" class="location-shared-badge" style="display:none;">‚úì Shared!</span>
                </button>
                <button class="action-btn chat" onclick="openChat()">
                    <span class="action-icon">üí¨</span>
                    <span id="chatText">Safety Chat</span>
                </button>
            </div>

            <!-- Safety Tips -->
            <div class="safety-tips">
                <h2>üõ°Ô∏è <span id="safetyTipsTitle">Stay Alert, Stay Safe</span></h2>
                <div id="safetyTipsList"></div>
            </div>
        </div>

        <!-- Contacts Page -->
        <div id="contactsPage" class="page">
            <button class="back-btn" onclick="navigateTo('homePage')">‚Üê <span id="homeText">Home</span></button>
            <h2>üìû <span id="emergencyContactsTitle">Emergency Contacts</span></h2>
            
            <div class="grid" id="emergencyContactsGrid"></div>

            <h3 id="trustedPeopleTitle">Trusted People</h3>
            <div id="trustedContactsList"></div>
        </div>

        <!-- Routes Page -->
        <div id="routesPage" class="page">
            <button class="back-btn" onclick="navigateTo('homePage')">‚Üê <span id="homeText2">Home</span></button>
            <h2>üó∫Ô∏è <span id="saferRouteTitle">Safer Routes</span></h2>
            
            <div class="grid">
                <button class="action-btn" style="background-color: #fef3c7; color: #92400e; border-color: #d97706;">
                    üè• <span id="hospitalsText">Hospitals</span>
                </button>
                <button class="action-btn" style="background-color: #fef3c7; color: #92400e; border-color: #d97706;">
                    üöî <span id="policeStationsText">Police Stations</span>
                </button>
                <button class="action-btn" style="background-color: #fef3c7; color: #92400e; border-color: #d97706;">
                    ‚úì <span id="safeZonesText">Safe Zones</span>
                </button>
            </div>

            <div style="background-color: #fef3c7; border: 4px solid #d97706; border-radius: 1rem; padding: 2rem; text-align: center;">
                <div style="font-size: 3.75rem; margin-bottom: 1rem;">üó∫Ô∏è</div>
                <p style="font-size: 1.25rem; font-weight: bold; color: #92400e;" id="selectDestination">Select your destination</p>
                <button style="margin-top: 1.5rem; padding: 1rem 2rem; background-color: #d97706; color: white; border: none; border-radius: 0.5rem; font-weight: bold; font-size: 1.125rem; cursor: pointer;" id="findSafeRouteBtn">
                    <span id="findSafeRouteText">Find Safe Route</span>
                </button>
            </div>
        </div>
    </main>

    <!-- Chat Modal -->
    <div id="chatModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üí¨ <span id="chatbotTitle">Safety Chat</span></h3>
                <button class="close-btn" onclick="closeChat()">‚úï</button>
            </div>
            <div class="modal-messages empty" id="chatMessages">
                <div style="font-size: 2.25rem; margin-bottom: 0.5rem;">üí¨</div>
                <p style="font-weight: 600; color: #831843;" id="askHelpText">Ask for help or tips...</p>
            </div>
            <div class="modal-input">
                <input type="text" id="chatInput" placeholder="Ask..." onkeypress="if(event.key==='Enter') sendMessage()">
                <button onclick="sendMessage()">üì§</button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav>
        <button onclick="navigateTo('homePage')" class="nav-btn active" data-page="homePage">üè†</button>
        <button onclick="navigateTo('contactsPage')" class="nav-btn" data-page="contactsPage">üìû</button>
        <button onclick="navigateTo('routesPage')" class="nav-btn" data-page="routesPage">üó∫Ô∏è</button>
    </nav>

    <script>
        let currentLanguage = 'en';
        let emergencyActive = false;
        let flashlightOn = false;
        let locationShared = false;
        let darkModeOn = false;
        let chatMessages = [];

        function toggleDarkMode() {
            darkModeOn = !darkModeOn;
            const btn = document.getElementById('darkModeBtn');
            if (darkModeOn) {
                document.body.classList.add('dark-mode');
                btn.textContent = '‚òÄÔ∏è Light';
                // Re-render trusted contacts so dark styles apply to freshly created elements
                updateTrustedContacts();
            } else {
                document.body.classList.remove('dark-mode');
                btn.textContent = 'üåô Dark';
                updateTrustedContacts();
            }
        }

        const translations = {
            en: {
                appName: 'SafeHer',
                home: 'Home',
                emergency: 'Emergency',
                saferRoute: 'Safer Routes',
                emergencyAlert: 'EMERGENCY ALERT',
                activateEmergency: 'Tap to Activate Emergency',
                alarmActive: 'ALARM ACTIVE - Get Help!',
                contactsText: 'Emergency Contacts',
                shareLocation: 'Share Location with Contacts',
                locationShared: 'Location Shared!',
                stopSharing: 'Stop Sharing',
                saferRouteTitle: 'Safer Routes',
                selectDestination: 'Select your destination',
                findSafeRoute: 'Find Safe Route',
                emergencyContactsTitle: 'Emergency Contacts',
                trustedPeopleTitle: 'Trusted People',
                safetyTipsTitle: 'Stay Alert, Stay Safe',
                chatbotTitle: 'Safety Chat Assistant',
                askHelp: 'Ask for help or tips...',
                flashlight: 'Flashlight',
                hospitalsText: 'Hospitals',
                policeStationsText: 'Police Stations',
                safeZonesText: 'Safe Zones',
                safetyTips: [
                    '‚úì Always share your location with trusted contacts',
                    '‚úì Avoid walking alone after dark',
                    '‚úì Keep emergency numbers saved',
                    '‚úì Trust your instincts',
                    '‚úì Stay aware of your surroundings',
                    '‚úì Use verified transportation services'
                ],
                chatResponses: [
                    'Stay in well-lit areas and avoid dark streets.',
                    'Always inform someone about your location.',
                    'Trust your instincts and leave uncomfortable situations.',
                    'Keep your phone charged and within reach.',
                    'Travel with friends when possible.',
                    'Use verified taxis or ride-sharing apps.'
                ]
            },
            hi: {
                appName: '‡§∏‡•á‡§´‡§º‡§π‡§∞',
                home: '‡§π‡•ã‡§Æ',
                emergency: '‡§Ü‡§™‡§æ‡§§',
                saferRoute: '‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§Æ‡§æ‡§∞‡•ç‡§ó',
                emergencyAlert: '‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§§‡§∞‡•ç‡§ï‡§§‡§æ',
                activateEmergency: '‡§Ü‡§™‡§æ‡§§ ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç',
                alarmActive: '‡§Ö‡§≤‡§∞‡•ç‡§ü ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø - ‡§Æ‡§¶‡§¶ ‡§≤‡•á‡§Ç!',
                contactsText: '‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï',
                shareLocation: '‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç',
                locationShared: '‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!',
                stopSharing: '‡§∏‡§æ‡§ù‡§æ‡§ï‡§∞‡§£ ‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç',
                saferRouteTitle: '‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§Æ‡§æ‡§∞‡•ç‡§ó',
                selectDestination: '‡§Ö‡§™‡§®‡§æ ‡§ó‡§Ç‡§§‡§µ‡•ç‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç',
                findSafeRoute: '‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§Æ‡§æ‡§∞‡•ç‡§ó ‡§ñ‡•ã‡§ú‡•á‡§Ç',
                emergencyContactsTitle: '‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï',
                trustedPeopleTitle: '‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏‡§™‡§æ‡§§‡•ç‡§∞ ‡§≤‡•ã‡§ó',
                safetyTipsTitle: '‡§∏‡§§‡§∞‡•ç‡§ï ‡§∞‡§π‡•á‡§Ç, ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡§π‡•á‡§Ç',
                chatbotTitle: '‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ö‡•à‡§ü ‡§∏‡§π‡§æ‡§Ø‡§ï',
                askHelp: '‡§Æ‡§¶‡§¶ ‡§Ø‡§æ ‡§∏‡•Å‡§ù‡§æ‡§µ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Ç‡§õ‡•á‡§Ç...',
                flashlight: '‡§ü‡•â‡§∞‡•ç‡§ö',
                hospitalsText: '‡§Ö‡§∏‡•ç‡§™‡§§‡§æ‡§≤',
                policeStationsText: '‡§™‡•Å‡§≤‡§ø‡§∏ ‡§∏‡•ç‡§ü‡•á‡§∂‡§®',
                safeZonesText: '‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞',
                safetyTips: [
                    '‚úì ‡§π‡§Æ‡•á‡§∂‡§æ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏‡§™‡§æ‡§§‡•ç‡§∞ ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§™‡§®‡§æ ‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç',
                    '‚úì ‡§Ö‡§Ç‡§ß‡•á‡§∞‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§Ö‡§ï‡•á‡§≤‡•á ‡§ö‡§≤‡§®‡•á ‡§∏‡•á ‡§¨‡§ö‡•á‡§Ç',
                    '‚úì ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§∏‡§π‡•á‡§ú‡•á‡§Ç',
                    '‚úì ‡§Ö‡§™‡§®‡•Ä ‡§™‡•ç‡§∞‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§™‡§∞ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç',
                    '‚úì ‡§Ö‡§™‡§®‡•á ‡§Ü‡§∏‡§™‡§æ‡§∏ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§ó‡§∞‡•Ç‡§ï ‡§∞‡§π‡•á‡§Ç',
                    '‚úì ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§™‡§∞‡§ø‡§µ‡§π‡§® ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç'
                ],
                chatResponses: [
                    '‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§§‡§∞‡§π ‡§∏‡•á ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡§æ‡§≤‡•á ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∞‡§π‡•á‡§Ç‡•§',
                    '‡§π‡§Æ‡•á‡§∂‡§æ ‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§∏‡•ç‡§•‡§æ‡§® ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§§‡§æ‡§è‡§Ç‡•§',
                    '‡§Ö‡§™‡§®‡•Ä ‡§™‡•ç‡§∞‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§™‡§∞ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',
                    '‡§Ö‡§™‡§®‡•á ‡§´‡•ã‡§® ‡§ï‡•ã ‡§ö‡§æ‡§∞‡•ç‡§ú ‡§∞‡§ñ‡•á‡§Ç‡•§',
                    '‡§Æ‡§ø‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§',
                    '‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ü‡•à‡§ï‡•ç‡§∏‡•Ä ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç‡•§'
                ]
            }
        };

        const emergencyContacts = {
            en: [
                { name: 'Police Emergency', number: '100', icon: 'üöî' },
                { name: 'Women Helpline', number: '1091', icon: 'üìû' },
                { name: 'Ambulance', number: '102', icon: 'üöë' }
            ],
            hi: [
                { name: '‡§™‡•Å‡§≤‡§ø‡§∏ ‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤', number: '100', icon: 'üöî' },
                { name: '‡§Æ‡§π‡§ø‡§≤‡§æ ‡§∏‡§π‡§æ‡§Ø‡§§‡§æ ‡§∞‡•á‡§ñ‡§æ', number: '1091', icon: 'üìû' },
                { name: '‡§è‡§Æ‡•ç‡§¨‡•Å‡§≤‡•á‡§Ç‡§∏', number: '102', icon: 'üöë' }
            ]
        };

        const trustedContacts = [
            { name: 'Mom', phone: '+91-9876543210' },
            { name: 'Sister', phone: '+91-8765432109' }
        ];

        function t(key) {
            return translations[currentLanguage][key] || key;
        }

        function changeLanguage() {
            currentLanguage = document.getElementById('languageSelect').value;
            updateLanguage();
        }

        function updateLanguage() {
            document.getElementById('appName').textContent = t('appName');
            document.getElementById('emergencyTitle').textContent = t('activateEmergency');
            document.getElementById('saferRouteText').textContent = t('saferRoute');
            document.getElementById('contactsText').textContent = t('contactsText');
            document.getElementById('locationText').textContent = t('shareLocation');
            document.getElementById('chatText').textContent = t('chatbotTitle');
            document.getElementById('safetyTipsTitle').textContent = t('safetyTipsTitle');
            document.getElementById('homeText').textContent = t('home');
            document.getElementById('homeText2').textContent = t('home');
            document.getElementById('emergencyContactsTitle').textContent = t('emergencyContactsTitle');
            document.getElementById('trustedPeopleTitle').textContent = t('trustedPeopleTitle');
            document.getElementById('saferRouteTitle').textContent = t('saferRouteTitle');
            document.getElementById('selectDestination').textContent = t('selectDestination');
            document.getElementById('findSafeRouteText').textContent = t('findSafeRoute');
            document.getElementById('hospitalsText').textContent = t('hospitalsText');
            document.getElementById('policeStationsText').textContent = t('policeStationsText');
            document.getElementById('safeZonesText').textContent = t('safeZonesText');
            document.getElementById('chatbotTitle').textContent = t('chatbotTitle');
            document.getElementById('askHelpText').textContent = t('askHelp');
            
            updateSafetyTips();
            updateEmergencyContacts();
            updateTrustedContacts();
        }

        function updateSafetyTips() {
            const tipsList = document.getElementById('safetyTipsList');
            tipsList.innerHTML = '';
            t('safetyTips').forEach(tip => {
                const p = document.createElement('p');
                p.textContent = tip;
                tipsList.appendChild(p);
            });
        }

        function updateEmergencyContacts() {
            const grid = document.getElementById('emergencyContactsGrid');
            grid.innerHTML = '';
            emergencyContacts[currentLanguage].forEach(contact => {
                const card = document.createElement('a');
                card.href = `tel:${contact.number}`;
                card.className = 'contact-card';
                card.innerHTML = `
                    <div class="contact-icon">${contact.icon}</div>
                    <div class="contact-name">${contact.name}</div>
                    <div class="contact-number">${contact.number}</div>
                `;
                grid.appendChild(card);
            });
        }

        function updateTrustedContacts() {
            const list = document.getElementById('trustedContactsList');
            list.innerHTML = '';
            const isDark = document.body.classList.contains('dark-mode');
            trustedContacts.forEach(contact => {
                const card = document.createElement('a');
                card.href = `tel:${contact.phone}`;
                if (isDark) {
                    card.style.cssText = 'display: block; background-color: #000000; border: 2px solid #ec4899; border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 0.75rem; text-decoration: none; color: #ffffff; cursor: pointer; transition: all 0.3s;';
                    card.onmouseover = () => card.style.boxShadow = '0 10px 25px rgba(236,72,153, 0.3)';
                    card.onmouseout = () => card.style.boxShadow = 'none';
                    card.innerHTML = `
                        <div style="color: #ec4899; font-weight: bold; font-size: 1.125rem;">üë§ ${contact.name}</div>
                        <div style="color: #ffffff; font-size: 0.875rem; margin-top: 0.5rem;">üì± ${contact.phone}</div>
                    `;
                } else {
                    card.style.cssText = 'display: block; background-color: #fbcfe8; border: 2px solid #ec4899; border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 0.75rem; text-decoration: none; color: inherit; cursor: pointer; transition: all 0.3s;';
                    card.onmouseover = () => card.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.1)';
                    card.onmouseout = () => card.style.boxShadow = 'none';
                    card.innerHTML = `
                        <div style="color: #be185d; font-weight: bold; font-size: 1.125rem;">üë§ ${contact.name}</div>
                        <div style="color: #831843; font-size: 0.875rem; margin-top: 0.5rem;">üì± ${contact.phone}</div>
                    `;
                }
                list.appendChild(card);
            });
        }

        function playAlarm() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.setValueAtTime(0, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function toggleEmergency() {
            const btn = document.getElementById('emergencyBtn');
            const icon = document.getElementById('emergencyIcon');
            const title = document.getElementById('emergencyTitle');
            const subtitle = document.getElementById('emergencySubtitle');

            if (!emergencyActive) {
                emergencyActive = true;
                btn.classList.add('active');
                icon.textContent = 'üö®';
                icon.classList.add('bounce');
                title.textContent = t('alarmActive');
                subtitle.innerHTML = 'üìç Location Shared | üìû Contacts Alerted';
                playAlarm();
                setTimeout(() => {
                    alert(currentLanguage === 'en' ? 'Emergency alert sent to contacts!' : '‡§Ü‡§™‡§æ‡§§‡§ï‡§æ‡§≤‡•Ä‡§® ‡§∏‡§§‡§∞‡•ç‡§ï‡§§‡§æ ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï‡•ã‡§Ç ‡§ï‡•ã ‡§≠‡•á‡§ú‡•Ä ‡§ó‡§à!');
                }, 300);
            } else {
                emergencyActive = false;
                btn.classList.remove('active');
                icon.textContent = '‚ö†Ô∏è';
                icon.classList.remove('bounce');
                title.textContent = t('activateEmergency');
                subtitle.textContent = 'Tap & Hold for 3 Seconds';
            }
        }

        function toggleFlashlight() {
            flashlightOn = !flashlightOn;
            const btn = document.getElementById('flashlightBtn');
            if (flashlightOn) {
                btn.classList.add('active');
                document.body.style.filter = 'brightness(2)';
            } else {
                btn.classList.remove('active');
                document.body.style.filter = 'brightness(1)';
            }
        }

        function toggleLocationSharing() {
            locationShared = !locationShared;
            const locationBtn = document.querySelector('.location');
            const locationStatus = document.getElementById('locationStatus');
            const locationText = document.getElementById('locationText');
            
            if (locationShared) {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        () => {
                            locationText.textContent = t('stopSharing');
                            locationStatus.style.display = 'block';
                        },
                        () => {
                            alert(currentLanguage === 'en' ? 'Unable to access location' : '‡§∏‡•ç‡§•‡§æ‡§® ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡§Æ‡§∞‡•ç‡§•');
                            locationShared = false;
                        }
                    );
                }
            } else {
                locationText.textContent = t('shareLocation');
                locationStatus.style.display = 'none';
            }
        }

        function openChat() {
            document.getElementById('chatModal').classList.add('active');
        }

        function closeChat() {
            document.getElementById('chatModal').classList.remove('active');
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const messagesContainer = document.getElementById('chatMessages');
            
            if (!input.value.trim()) return;

            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'chat-message user';
            userMsg.innerHTML = `<div class="chat-bubble">${input.value}</div>`;
            messagesContainer.appendChild(userMsg);

            if (messagesContainer.classList.contains('empty')) {
                messagesContainer.classList.remove('empty');
            }

            // Add assistant response
            const responses = t('chatResponses');
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            
            setTimeout(() => {
                const assistantMsg = document.createElement('div');
                assistantMsg.className = 'chat-message assistant';
                assistantMsg.innerHTML = `<div class="chat-bubble">${randomResponse}</div>`;
                messagesContainer.appendChild(assistantMsg);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 500);

            input.value = '';
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function navigateTo(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            const navBtn = document.querySelector(`[data-page="${pageId}"]`);
            if (navBtn) navBtn.classList.add('active');
        }

        // Initialize
        updateLanguage();
    </script>
</body>
</html>
